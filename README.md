# Road_signs_in_Moscow_streets (Дорожные знаки на улицах Москвы)
# Идея проекта
На улицах Москвы огромное количество дорожных знаков. Интересно, сколько их всего? А сколько их на моей улице? Модуль, написанный в ходе данного проекта, позволяет узнать, какое количество дорожных знаков каждого типа встречается на любой улице Москвы и вновь присоединенных территорий Новой Москвы и рассчитать плотность размещения дорожных знаков на ней.
# Датасеты

Основной датасет был найден на Портале открытых данных Правительства Москвы (https://data.mos.ru/opendata/62681?pageSize=10&pageIndex=0&isDynamic=false&version=1&release=42) под названием "Дорожные знаки" и выгружен в формате CSV. Из-за большого объема датасета с его загрузкой (особенно в дневное время) возникают проблемы, поэтому он приложен в папке /data.7z. Датасет представляет из себя список из более чем 560 тысяч строк, в которых описаны параметры каждого дорожного знака, установленного в городе. В таблице представлены округ и район, в которых расположен знак, адресный ориентир (дома по какому адресу расположены рядом со знаком и на каком удалении от него), тип дорожного знака (например, 3.27 Остановка запрещена) и его географические координаты. 

Далее требовался датасет с длиной улиц Москвы. Найти такого в открытом доступе не удалось, поэтому пришла идея сделать собственный. В QGIS с использованием плагина QuickOSM был загружен шейп-файл со всеми дорогами Москвы. Используя встроенный в QGIS калькулятор полей для каждого объекта была рассчитана его длина. Полученные данные были экпортированы в качестве CSV-таблицы, также приложенной в /data.7z.

# Трудности перевода
Основной проблемой в подготовке данных стал адресный ориентир дорожных знаков, информация в котором не всегда записана стандартизированно. Для многих дорожных знаков, особенно недавно установленных в Новой Москве, адресного ориентира нет вообще, поэтому они не учитывались при обработке. Стандартная запись представляет из себя строку из 3-4 адресов, разделенных запятыми, с названием улицы с большой буквы и номером дома/строения/корпуса, а также расстоянием до знака в метрах. Однако во многих случаях расстояние до знака отсутствует, или номер дома отделен от улицы не запятой, а пробелом. Для решения данных проблем была написана функция *cleaner*, которая выделяла бы из адресного ориентира только названия улиц.
## Особенности нейминга московских улиц
В Москве основными типами улиц являются, собственно, улицы, проспекты, шоссе, бульвары, переулки и проезды. Для унификации идентификатор ("улица", "бульвар", "переулок") было решено удалять, оставляя только название. Но и с названием все было не так просто. 
### Какие улицы бывают в Москве?
Рассмотрим, какие названия улиц встречаются в Москве и какие особенности в названии небходимо учитывать.
1. "__Easy mode__" - улицы, состоящие из одного слова: Кировоградская улица, Моховая улица
2. "__Beat me__" - улицы, состоящие из двух слов: улица Воронцово Поле, улица Старый Гай
3. "__Professional__" - улицы с приставками "Большой(-ая)", "Малый(-ая)": Большая Тульская улица, Малый Каретный переулок
4. "__Hard__" - улицы с числовыми приставками: 1-я Кожуховская улица, 3-я Рощинская улица
5. "__Impossible__" - улицы с нарицательными приставками: улица Адмирала Лазарева, улица Академика Янгеля.
6. "__Fatality__" - ???: 2-я улица Измайловского Зверинца, 5-й проезд Марьиной Рощи
7. "__Wasted__" - улицы с числовыми названиями: улица 1905 года, улица 8 Марта
   
Со всем этим нужно было разобраться.

## Что получилось с *cleaner*?
Синтаксис записи улиц в датасет выглядит так: *название улицы*, *любая приставка* (1-ая, М.=Малая, Адмирала), *слово-классификатор* (ул.=улица, пер.=переулок и пр.)
Функция cleaner превращает строку-запись в адресном ориентире в список названий улиц, около которых расположен дорожный знак, отбрасывая всю лишнюю числовую информацию. Все приставки записаны после названия, классификаторы удаляются. В некоторых записях в выходной список попадает лишняя информация, но так как данная информация представлена в виде элементов, которые в дальнейшем сравниваются с введенной улицей, на работу программы она не влияет.

## Что пока не получилось с *cleaner* и что будет добавлено?
К сожалению, про существование уровня "__Wasted__" мы вспомнили слишком поздно, и уже не успели переработать код, поэтому точная работа модуля для улиц, содержащих цифры в названии, не гарантируется (к счастью, таких в Москве всего 3).

# Работа с длинами
Для работы со вторым датасетом была написана отдельная функция *len_format*. Дело в том, что данные об улицах в нем представлены в формате *слово-классификатор* без сокращений, *любая приставка*, *название улицы*, поэтому функция *cleaner* не подходила. *Len-format* приводит название улицы из датасета с длинами к формату датасета с дорожными знаками. 

## Что пока не получилось реализовать (возможно, будет добавлено в будущем)
К сожалению, не до конца удалось  грамотно настроить работу данной функции с названиями из класса "__impossible__", так как приставки в датасетах располагаются в другом порядке, а нарицательная приставка идентична второму слову в названии улицы (для *len_format* 'улица Красных Зорь'='улица Академика Понтрягина'), тогда как в датасете с дорожными знаками в случае с 'Академика Понтрягина' написание было бы обратным.

# Использование модуля
### Необходимые дополнительные модули и пути к файлам
Для работы с модулем его необходимо запустить в любом компиляторе Python с поддержкой модуля CSV (в оригинале был написан с помощью интерпретатора Anaconda3). Для корректной работы модуля папка */data* с датасетами должны быть помещена в одной папке с файлом *.py*. 
### Как все работает
Модуль получает на вход название улицы в установленном формате, примечания по формату входной строки отображаются на консоли при запуске. Модуль создает в папке */data* новую CSV-таблицу, названную введенным названием улицы. Если плотность размещения дорожных знаков рассчитать не удалось, столбик будет заполнен *Null*. Примеры выходных CSV-таблиц приложены в проекте в архиве *examples*.

# Список авторов 
Проект был подготовлен студентами ФГГТ 2-го курса Воскобойниковой Марией Алексеевной и Диденко Игорем Владимировичем. Вопросы и предложения по оптимизации и доработке модуля принимаются: t.me/marrrria, t.me/commuterra
